<html>
  <head>
    <title>Campfire - Real time campaign monitoring and insights </title>
    <script src="https://statics.teams.microsoft.com/sdk/v1.4.2/js/MicrosoftTeams.min.js" crossorigin="anonymous"></script>
    <script>
      function teamsIntialize(){
        microsoftTeams.settings.registerOnSaveHandler(function(saveEvent){
          var radios = document.getElementsByName("maptype");
          if (radios[0].checked) {
               microsoftTeams.settings.setSettings({
                 entityId: "bing",
                 contentUrl: "https://www.bing.com/maps/embed",
                 suggestedDisplayName: "Bing Map",
                 websiteUrl: "https://www.bing.com/maps",
                 removeUrl: "https://teams-get-started-sample.azurewebsites.net/tabremove.html",
              });
          } else {
               microsoftTeams.settings.setSettings({
                 entityId: "google",
                 contentUrl: "https://www.google.com/maps/embed",
                 suggestedDisplayName: "Google Map",
                 websiteUrl: "https://www.google.com/maps",
                 removeUrl: "https://teams-get-started-sample.azurewebsites.net/tabremove.html",
              });
          }

          saveEvent.notifySuccess();
      });
      function onClick() {
          microsoftTeams.settings.setValidityState(true);
      }
     }
    </script>
  </head>
  <body onload="teamsIntialize()">
    <h1>Campfire</h1>
    <h2>Real time campaign monitoring and insights</h2>
    <form>
      <input type="radio" name="maptype" value="bing" onclick="onClick()"> Bing Maps<br>
      <input type="radio" name="maptype" value="google" onclick="onClick()"> Google Maps
    </form>
  </body>
</html>
